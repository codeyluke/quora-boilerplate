<div class="card border-primary mb-5">
    <%@questions.each do |q|%>
        <div class="card-header d-flex"> 
            <div class="question flex-grow-1">
                <%="Q: #{q.question}"%> 
            </div>
            <div class="options-question">
                <a href='/question/<%= q.id %>/edit'>Edit</a>
                <a href='/question/<%= q.id %>/delete'>Delete</a>
            </div>
        </div>

        <div class="card-body">
            <%Answer.where(question_id:q.id).each do |a|%>
                <div class="d-flex">
                    <div class="flex-grow-1">
                        <%= "A: #{a.answer} by #{a.user.name}" %>
                    </div>
                    <div class="options-answer">
                        <a href='/answer/<%=a.id%>/edit'>Edit</a>
                        <a href='/answer/<%=a.id%>/delete'>Delete</a>
                    </div>
                </div>
                <%# ======= VOTES ======= %>
                <div class="current-votes-<%=a.id%>">
                    Answer Votes - <%= a.votes.count %> 
                </div>
            
                <button class="btn btn-outline-primary btn-vote-up" value="<%=a.id%>">Up Vote</button>
                <button class="btn btn-outline-danger btn-vote-remove" value="<%=a.id%>">Remove Vote</button>              
                
                <br>
            <%end%>
            <br>

            <form method="post" action="/question/<%= q.id %>/answers/add">
                <input class="form-control" type=text placeholder="answer the question" name="answer"><br>
                <input class="btn btn-primary" type=submit value="Add Answer">
            </form>
        </div>
    <%end%>
</div>
<hr>

<form method="post" action="/add_question">
    <input type=text placeholder="ask your question" name="question"><br>
    <input type=submit value="Add Question">
</form>

<hr>
<%# ======================= OTHER QUESTIONS ======================= %>
<h3 class="text-center">Other Questions</h3>

<div class="card border-primary mb-5">
   
    <% @all_questions.each do |all_q| %>
   
        <% if all_q.user_id != current_user.id %>
            <div class="card-header">
                <%= "Q: #{all_q.question} by #{all_q.user.name}" %><br>
            </div> 
            <div class="card-body">            
                <% @all_answers.each do |all_a| %>
                    <%if all_a.question_id == all_q.id %>
                        <div class="d-flex">
                            <div class="flex-grow-1">
                                <%= "A: #{all_a.answer} by #{all_a.user.name}" %>
                            </div>
                            <div>
                                <a href='/answer/<%=all_a.id%>/edit'>Edit</a>
                                <a href='/answer/<%=all_a.id%>/delete'>Delete</a>
                            </div>
                        </div>
                                                
                        <div class="current-votes-<%=all_a.id%>">
                            Answer Votes - <%= all_a.votes.count %> 
                        </div>

                        <button class="btn btn-outline-primary btn-vote-up" value="<%=all_a.id%>">Up Vote</button>
                        <button class="btn btn-outline-danger btn-vote-remove" value="<%=all_a.id%>">Remove Vote</button> 
                                     
                    <%end%>
                <%end%>
                
                <form method="post" action="/question/<%= all_q.id %>/answers/add">
                    <input class="mt-3 form-control" type=text placeholder="answer the question" name="answer"><br>
                    <input class="btn btn-primary" type=submit value="Add Answer">
                </form> 

            </div> 
        <% end %>
    <% end %>

</div>